{% extends "worker_base.html" %}
{% block worker_content %}

<div class="card">
  <div class="h2">ğŸ“¦ ì¬ê³  ì¡°íšŒ</div>

  <div class="row">
    <a class="btn" href="/api/export/inventory">â¬‡ï¸ ì¬ê³  ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</a>
    <a class="btn" href="/labels">ğŸ· ë¼ë²¨ ì¶œë ¥</a>
  </div>

  <div class="hr"></div>

  <div class="form">
    <input id="q" placeholder="í’ˆë²ˆ/í’ˆëª…/LOT ê²€ìƒ‰" />
    <button class="btn primary" onclick="search()">ê²€ìƒ‰</button>
  </div>

  <div class="tablewrap">
    <table class="table" id="tbl">
      <thead>
        <tr>
          <th>ì°½ê³ </th><th>ë¡œì¼€ì´ì…˜</th><th>ë¸Œëœë“œ</th>
          <th>í’ˆë²ˆ</th><th>í’ˆëª…</th><th>LOT</th><th>ê·œê²©</th>
          <th class="right">ìˆ˜ëŸ‰</th><th>ì—…ë°ì´íŠ¸</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
async function load(q=""){
  const res = await fetch("/api/inventory?q=" + encodeURIComponent(q));
  const rows = await res.json();
  const tb = document.querySelector("#tbl tbody");
  tb.innerHTML = rows.map(r=>`
    <tr>
      <td>${r.warehouse||""}</td>
      <td><a href="/loc?location=${encodeURIComponent(r.location||"")}" class="link">${r.location||""}</a></td>
      <td>${r.brand||""}</td>
      <td>${r.item_code||""}</td>
      <td>${r.item_name||""}</td>
      <td>${r.lot_no||""}</td>
      <td>${r.spec||""}</td>
      <td class="right"><b>${r.qty||0}</b></td>
      <td>${r.updated_at||""}</td>
    </tr>
  `).join("");
}
function search(){
  load(document.getElementById("q").value.trim());
}
load();
</script>

{% endblock %}
