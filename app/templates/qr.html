{% extends "worker_base.html" %}
{% block content %}

<h2>ğŸ“· QR ìŠ¤ìº”</h2>
<video id="preview" width="100%"></video>
<script src="/static/qr.js"></script>



<h3>QR ìŠ¤ìº”</h3>

<input
  id="qr"
  placeholder="QR ìŠ¤ìº”"
  autofocus
  onkeydown="if(event.key==='Enter'){ scan(); }"
/>

<button onclick="scan()">ìë™ ì²˜ë¦¬</button>

<div id="result" style="margin-top:15px;"></div>

<script>
async function scan() {
  const qr = document.getElementById("qr").value;

  const res = await fetch("/api/qr/process", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ qr_data: qr })
  });

  const data = await res.json();

  document.getElementById("result").innerHTML =
    "âœ… ì²˜ë¦¬ ì™„ë£Œ : " + data.action;

  // 0.7ì´ˆ í›„ ì‘ì—…ì ë©”ì¸ ë³µê·€
  setTimeout(() => location.href = "/worker", 700);
}
</script>

{% endblock %}
