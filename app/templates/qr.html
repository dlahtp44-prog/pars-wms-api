{% extends "worker_base.html" %}
{% block content %}

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>QR ìŠ¤ìº”</title>
</head>
<body>
<h2>ğŸ“· QR ìŠ¤ìº”</h2>

<input id="qr" placeholder="QR ì½”ë“œ ê°’">
<button onclick="send()">ì…ê³ /ì´ë™ ì²˜ë¦¬</button>

<script>
function send(){
  fetch('/api/qr/process', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({qr:document.getElementById('qr').value})
  }).then(()=>alert('ì²˜ë¦¬ ì™„ë£Œ'));
}
</script>
</body>
</html>


<h3>QR ìŠ¤ìº”</h3>

<input
  id="qr"
  placeholder="QR ìŠ¤ìº”"
  autofocus
  onkeydown="if(event.key==='Enter'){ scan(); }"
/>

<button onclick="scan()">ìë™ ì²˜ë¦¬</button>

<div id="result" style="margin-top:15px;"></div>

<script>
async function scan() {
  const qr = document.getElementById("qr").value;

  const res = await fetch("/api/qr/process", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ qr_data: qr })
  });

  const data = await res.json();

  document.getElementById("result").innerHTML =
    "âœ… ì²˜ë¦¬ ì™„ë£Œ : " + data.action;

  // 0.7ì´ˆ í›„ ì‘ì—…ì ë©”ì¸ ë³µê·€
  setTimeout(() => location.href = "/worker", 700);
}
</script>

{% endblock %}
