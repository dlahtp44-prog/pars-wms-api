let currentStep = 1; // 1: 출발지 스캔, 2: 품목 선택, 3: 도착지 스캔
let moveData = { from: '', item: '', qty: 0 };

async function onScanSuccess(decodedText) {
    if (currentStep === 1) {
        // 출발지 인식
        const res = await fetch(`/api/qr/location/${decodedText}`);
        const items = await res.json();
        if (items.length > 0) {
            moveData.from = decodedText;
            renderItems(items); // 품목 리스트를 화면에 표시
            currentStep = 2;
        }
    } else if (currentStep === 3) {
        // 도착지 인식 및 이동 확정
        const res = await fetch('/api/move/manual', {
            method: 'POST',
            body: JSON.stringify({ ...moveData, to_location: decodedText })
        });
        if (res.ok) alert("이동 완료!");
    }
}
