<script>
async function processQR(text){
  const params = new URLSearchParams(text);
  const type = params.get("type");

  if(type === "LOCATION"){
    const loc = params.get("location");
    const res = await fetch(`/api/location/inventory?location=${loc}`);
    const data = await res.json();
    renderLocationInventory(data);
    return;
  }

  if(type === "ITEM"){
    alert("ì œí’ˆ QRì…ë‹ˆë‹¤. ì…ê³ /ì¶œê³ /ì´ë™ í™”ë©´ì—ì„œ ì‚¬ìš©í•˜ì„¸ìš”.");
    return;
  }

  alert("ì•Œ ìˆ˜ ì—†ëŠ” QR");
}

function renderLocationInventory(data){
  let html = `<h3>ğŸ“ ${data.location} ì¬ê³ </h3>`;
  html += `<table class="table">
    <tr>
      <th>í’ˆë²ˆ</th><th>í’ˆëª…</th><th>ë¸Œëœë“œ</th>
      <th>ê·œê²©</th><th>LOT</th><th>ìˆ˜ëŸ‰</th>
    </tr>`;

  for(const r of data.items){
    html += `
    <tr>
      <td>${r.item_code}</td>
      <td>${r.item_name}</td>
      <td>${r.brand}</td>
      <td>${r.spec}</td>
      <td>${r.lot_no}</td>
      <td class="right">${r.qty}</td>
    </tr>`;
  }

  html += "</table>";
  document.getElementById("result").innerHTML = html;
}
</script>
