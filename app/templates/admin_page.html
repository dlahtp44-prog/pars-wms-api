<div class="container mt-4">
    <h3>ğŸ› ï¸ ê´€ë¦¬ì ì‘ì—… ë¡œê·¸ (ë¡¤ë°± ê´€ë¦¬)</h3>
    <table class="table table-bordered table-hover mt-3">
        <thead class="table-dark">
            <tr>
                <th>ì‹œê°„</th><th>êµ¬ë¶„</th><th>ì°½ê³ </th><th>ë¡œì¼€ì´ì…˜</th><th>í’ˆë²ˆ</th><th>í’ˆëª…</th><th>LOT</th><th>ê·œê²©</th><th>ìˆ˜ëŸ‰</th><th>ê¸°ëŠ¥</th>
            </tr>
        </thead>
        <tbody id="logTable">
            </tbody>
    </table>
</div>

<script>
async function loadLogs() {
    const res = await fetch('/api/admin/logs');
    const logs = await res.json();
    const html = logs.map(log => `
        <tr>
            <td>${log.created_at}</td>
            <td><span class="badge ${log.tx_type === 'IN' ? 'bg-primary' : 'bg-danger'}">${log.tx_type}</span></td>
            <td>${log.warehouse}</td><td>${log.location}</td><td>${log.item_code}</td>
            <td>${log.item_name}</td><td>${log.lot_no}</td><td>${log.spec}</td><td>${log.qty}</td>
            <td><button class="btn btn-sm btn-warning" onclick="rollback(${log.id})">ë¡¤ë°±</button></td>
        </tr>
    `).join('');
    document.getElementById('logTable').innerHTML = html;
}

async function rollback(id) {
    if(!confirm('ì´ ì‘ì—…ì„ ì·¨ì†Œí•˜ê³  ì¬ê³ ë¥¼ ì›ìƒë³µêµ¬ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
    const res = await fetch(`/api/admin/rollback/${id}`, {method: 'POST'});
    if(res.ok) { alert('ë¡¤ë°± ì™„ë£Œ'); loadLogs(); }
}
loadLogs();
</script>
