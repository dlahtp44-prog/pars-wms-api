{% extends "base.html" %}
{% block content %}

<div class="row" style="justify-content:space-between;align-items:center;">
  <h2 class="title">ğŸ›  ê´€ë¦¬ì</h2>
  <a class="btn gray" href="/admin/logout">ë¡œê·¸ì•„ì›ƒ</a>
</div>

<div class="tablewrap">
  <table class="table">
    <thead>
      <tr>
        <th>ID</th><th>êµ¬ë¶„</th><th>ì°½ê³ </th><th>ë¡œì¼€ì´ì…˜</th><th>ë¸Œëœë“œ</th><th>í’ˆë²ˆ</th><th>í’ˆëª…</th><th>LOT</th><th>ê·œê²©</th>
        <th class="right">ìˆ˜ëŸ‰</th><th>ì‘ì—…</th>
      </tr>
    </thead>
    <tbody>
    {% for r in rows %}
      <tr>
        <td>{{ r.id }}</td>
        <td>{{ r.tx_type }}</td>
        <td>{{ r.warehouse }}</td>
        <td>{{ r.location }}</td>
        <td>{{ r.brand }}</td>
        <td>{{ r.item_code }}</td>
        <td>{{ r.item_name }}</td>
        <td>{{ r.lot_no }}</td>
        <td>{{ r.spec }}</td>
        <td class="right"><b>{{ r.qty }}</b></td>
        <td>
          <button class="smallbtn" onclick="doRollback({{r.id}})">ë¡¤ë°±</button>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>
</div>

<script>
async function doRollback(id){
  if(!confirm("ì´ ì‘ì—…ì„ ë¡¤ë°±(ë˜ëŒë¦¬ê¸°)í• ê¹Œìš”?")) return;
  const res = await fetch(`/api/history/rollback/${id}`, {method:"POST"});
  const j = await res.json();
  alert(j.msg || "ì™„ë£Œ");
  location.reload();
}
</script>

{% endblock %}
