<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ì…ê³  ì²˜ë¦¬</title>
<style>
body { font-family: sans-serif; padding: 16px; }
select, input, button {
  width: 100%; margin: 8px 0; padding: 10px; font-size: 16px;
}
button { background:#2ecc71; color:white; border:none; }
</style>
</head>
<body>

<h2>ğŸ“¦ ì…ê³  ì²˜ë¦¬</h2>

<input id="item" placeholder="í’ˆëª©ì½”ë“œ" />
<input id="qty" type="number" placeholder="ìˆ˜ëŸ‰" />

<select id="warehouse"></select>
<select id="zone"></select>
<select id="rack"></select>
<select id="cell"></select>

<button onclick="submitInbound()">ì…ê³  ì²˜ë¦¬</button>

<script>
let data = {};

fetch("/locations")
  .then(res => res.json())
  .then(json => {
    data = json;
    const wh = document.getElementById("warehouse");
    wh.innerHTML = `<option value="">ì°½ê³  ì„ íƒ</option>`;
    Object.keys(data).forEach(w =>
      wh.innerHTML += `<option value="${w}">${w}</option>`
    );
  });

warehouse.onchange = () => {
  zone.innerHTML = "";
  rack.innerHTML = "";
  cell.innerHTML = "";

  Object.keys(data[warehouse.value]).forEach(z =>
    zone.innerHTML += `<option value="${z}">${z}</option>`
  );
};

zone.onchange = () => {
  rack.innerHTML = "";
  cell.innerHTML = "";

  Object.keys(data[warehouse.value][zone.value]).forEach(r =>
    rack.innerHTML += `<option value="${r}">${r}</option>`
  );
};

rack.onchange = () => {
  cell.innerHTML = "";
  data[warehouse.value][zone.value][rack.value]
    .forEach(c =>
      cell.innerHTML += `<option value="${c}">${c}</option>`
    );
};

function submitInbound() {
  const url = `/inbound?item=${item.value}&qty=${qty.value}` +
              `&warehouse=${warehouse.value}` +
              `&zone=${zone.value}` +
              `&rack=${rack.value}` +
              `&level=01&cell=${cell.value}`;

  fetch(url, { method: "POST" })
    .then(r => r.json())
    .then(r => alert(JSON.stringify(r)));
}
</script>

</body>
</html>
