{% extends "base.html" %}
{% block content %}

<h2 class="title">ğŸ“Š ëŒ€ì‹œë³´ë“œ</h2>

<div class="grid">
  <div class="card">
    <div class="label">ì˜¤ëŠ˜ ì…ê³ </div>
    <div class="value" id="inbound">0</div>
  </div>
  <div class="card">
    <div class="label">ì˜¤ëŠ˜ ì¶œê³ </div>
    <div class="value" id="outbound">0</div>
  </div>
  <div class="card">
    <div class="label">ì´ ì¬ê³ </div>
    <div class="value" id="total">0</div>
  </div>
  <div class="card warn">
    <div class="label">ìŒìˆ˜ ì¬ê³ </div>
    <div class="value" id="negative">0</div>
  </div>
</div>

<hr class="hr">

<canvas id="trendChart" height="120"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
async function loadSummary(){
  const d = await fetch('/api/dashboard/summary').then(r=>r.json());
  inbound.innerText = d.inbound_today;
  outbound.innerText = d.outbound_today;
  total.innerText = d.total_stock;
  negative.innerText = d.negative_stock;
}

async function loadTrend(){
  const data = await fetch('/api/dashboard/trend').then(r=>r.json());
  new Chart(document.getElementById('trendChart'),{
    type:'bar',
    data:{
      labels:data.map(r=>r.date),
      datasets:[
        {label:'ì…ê³ ',data:data.map(r=>r.inbound),backgroundColor:'#2563eb'},
        {label:'ì¶œê³ ',data:data.map(r=>r.outbound),backgroundColor:'#ef4444'}
      ]
    },
    options:{responsive:true}
  });
}

loadSummary();
loadTrend();
</script>

<style>
.title{font-size:20px;margin-bottom:10px}
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media(min-width:900px){.grid{grid-template-columns:repeat(4,1fr)}}
.card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:12px}
.card.warn{border-color:#ef4444}
.label{font-size:12px;color:#6b7280}
.value{font-size:22px;font-weight:800}
.hr{margin:16px 0;border:none;border-top:1px solid #e5e7eb}
</style>

{% endblock %}
